# 检测GPU实例是否在使用测试许可证

用于临时测试的许可证即将过期，过期后继续使用该许可证的GPU实例不能通过NVIDIA GRID获得GPU加速能力。为保证业务平稳运行，请您尽快确认GPU实例是否正在使用测试许可证，并作出相应处理。本文以Windows Server 2016和Ubuntu 18.04为例，介绍如何检测并处理。

## Windows Server 2016系统的检测与处理

1.  检测是否使用了测试许可证。

    1.  远程连接实例。

        连接实例的操作，请参见[通过密码或密钥认证登录Windows实例](/cn.zh-CN/实例/连接实例/使用Workbench连接实例/通过密码或密钥认证登录Windows实例.md)。

    2.  在桌面单击右键，然后选择**NVIDIA控制面板**。

    3.  在**NVIDIA控制面板**页面，单击**许可** \> **管理许可证**。

    4.  查看许可证服务器信息。

        如果许可证服务器信息中包含以下任一组服务器和端口号，即表示GPU实例在使用测试许可证。

        |一级许可证服务器或者二级许可证服务器|端口号|
        |------------------|---|
        |egs-hz.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-bj.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-sh.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-sz.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-zjk.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-hhht.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-cd.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-hy.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-xjp.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-useast.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|

        示例如下图所示。

        ![grid-license-windows](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3048058951/p141157.png)

2.  如果使用了测试许可证，并且需要继续使用NVIDIA GRID提供GPU加速能力，则更换GPU实例的操作系统，改为阿里云镜像市场中已预装GRID驱动并激活许可证的收费镜像。

    **警告：** 实例更换操作系统后，云盘ID会变更，原系统盘会被释放。如果需要保留数据，请在操作前做好备份。

    1.  停止GPU实例。

        具体操作请参见[停止实例](/cn.zh-CN/实例/管理实例/停止实例.md)。

    2.  为GPU实例更换操作系统。

        具体操作请参见[更换系统盘（非公共镜像）](/cn.zh-CN/块存储/云盘基础操作/更换系统盘/更换系统盘（非公共镜像）.md)。更换操作系统时，在镜像市场搜索关键字GRID，并根据您的操作系统选择镜像。

        ![grid-imagemarket](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3048058951/p141179.png)

        **说明：** 如果镜像市场暂未上线您需要的镜像类型，请自行获取许可证并搭建许可证服务器。


## Ubuntu 18.04系统的检测与处理

1.  检测是否使用了测试许可证。

    1.  远程连接实例。

        连接实例的操作，请参见[通过密码或密钥认证登录Linux实例](/cn.zh-CN/实例/连接实例/使用Workbench连接实例/通过密码或密钥认证登录Linux实例.md)。

    2.  执行命令查看许可证服务器信息。

        ```
        cat /etc/nvidia/gridd.conf | grep 'ServerAddress\|ServerPort'
        ```

        如果返回的许可证服务器信息中包含以下任一组服务器和端口号，即表示您的GPU实例在使用测试许可证。

        |ServerAddress|ServerPort|
        |-------------|----------|
        |egs-hz.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-bj.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-sh.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-sz.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-zjk.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-hhht.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-cd.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-hy.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-xjp.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|
        |egs-useast.alibaba-inc.com|您在添加许可证服务器时填写的端口号，默认为7070。|

        示例如下图所示。

        ![查看测试License](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3048058951/p141108.png)

2.  获取许可证并搭建许可证服务器。

    目前阿里云暂未提供激活许可证的Linux收费镜像。确认在使用测试许可证后，如果需要继续使用NVIDIA GRID提供GPU加速能力，您可以自行获取许可证并搭建许可证服务器。

    1.  向NVIDIA购买许可证。

    2.  搭建许可证服务器。

        搭建许可证服务器方法，请参见NVIDIA官方文档[Virtual GPU License Server Version 2020.05](http://grid-9-4-zyy.oss-cn-hangzhou.aliyuncs.com/grid-license-server-user-guide.pdf)。


