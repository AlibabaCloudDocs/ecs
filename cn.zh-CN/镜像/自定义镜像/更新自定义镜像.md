---
keyword: [OOS, 自动化运维, 创建镜像, 补丁升级, ecs, 应用更新, 弹性]
---

# 更新自定义镜像

运维编排服务OOS为更新自定义镜像的场景提供了公共模版。您只需选择一个源镜像，输入更新镜像所需的云助手脚本等必要参数，就可以创建立即执行或定时执行的运维任务，一键更新自定义镜像。

更新自定义镜像会自动创建临时资源并采用按量付费计费方式。开通按量付费ECS资源时，您的阿里云账户余额（即现金余额）和代金券的总值不得小于100.00元人民币。

在更新自定义镜像的完整流程中，运维编排服务OOS的ACS-ECS-UpdateImage公共模板按顺序执行以下任务，并生成新的自定义镜像：

1.  检查新自定义镜像的名称是否已存在，以及是否符合规则。
2.  根据您配置的实例规格、源镜像ID、安全组ID等参数创建并运行一台临时ECS实例。
3.  检查临时ECS实例是否安装了云助手客户端，若缺失则安装云助手客户端。
4.  在临时ECS实例上，通过云助手执行脚本更新实例系统环境。

    **说明：** 运维编排服务OOS通过调用云助手API执行Shell、Bat或者PowerShell等脚本，更新ECS实例的系统应用环境。更多详情，请参见[云助手概述](/cn.zh-CN/运维与监控/云助手/云助手概述.md)。

5.  停止临时ECS实例。
6.  根据临时ECS实例创建自定义镜像。
7.  释放临时ECS实例。

1.  登录[ECS管理控制台](https://ecs.console.aliyun.com)。

2.  在左侧导航栏，选择**实例与镜像** \> **镜像**。

3.  在顶部菜单栏左上角处，选择地域。

4.  在**镜像**页面，选择**自定义镜像**页签。

5.  找到目标镜像，在**操作**栏单击![更多操作](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/2403222061/p171570.png)图标，然后单击**更新镜像**。

6.  跳转至OOS管理控制台后，完成以下配置：

    1.  完成通用设置，包括输入新镜像名称和描述，并指定执行所使用到的权限来源。

    2.  完成镜像分发设置。您可以根据需要设置是否复制或共享该镜像。

    3.  选择镜像。如果您在前一步操作已选择了目标镜像，此时将自动选中，请确认已选的镜像是否为需要操作的镜像。

    4.  配置中转实例，设置用于创建临时ECS实例的专有网络、交换机、安全组和实例类型。

    5.  发送远程命令。您可以根据需要选择命令类型并输入命令内容，该命令内容将在临时创建的ECS实例中执行。

    6.  完成高级选项配置。您可以根据需要设置伸缩组配置，添加标签或将当前配置保存为模板。

7.  单击**立即执行**，并在弹出的对话框中确认提示信息。

8.  在**创建或更新镜像**页面，您可以查看任务运行情况。


若成功创建运维任务，且执行状态处于**运行中**，则表示更新镜像正在进行中。当执行状态转换为**成功**时，则表示镜像更新成功，您可以在基本详情的输出参数中查看新镜像ID。

![OOS更新镜像](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6881482061/p171605.png)

**说明：** 如需了解更新镜像的详细过程，您可单击该执行的**详情**后，单击**日志**页签了解运维任务的实时进度和状态。

**相关文档**  


[什么是运维编排服务](https://help.aliyun.com/document_detail/120556.htm)

[使用运维编排创建和更新自定义镜像](https://help.aliyun.com/document_detail/140103.htm)

