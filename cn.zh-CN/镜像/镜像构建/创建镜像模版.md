# 创建镜像模版

您可以通过镜像模版定制镜像内容，并支持跨地域跨账号构建镜像。本文介绍如何通过ECS控制台创建镜像模版。

-   在操作前，您需要先阅读以下注意事项：
    -   仅支持创建您自定义的镜像模版。
    -   仅支持设置Linux系统的公共镜像、自定义镜像、共享镜像或者镜像族系。
    -   通过镜像模版构建镜像时，需要创建中转实例辅助构建镜像，中转实例为按量计费的ECS实例，将收取一定的费用。更多信息，请参见[按量付费](/cn.zh-CN/产品计费/计费方式/按量付费.md)。
    -   命令内容大小不能超过16 KB，命令设置的上限为127个。
-   镜像模版的**构建模版**支持的命令详情，请参见[镜像构建服务支持的命令说明](/cn.zh-CN/镜像/镜像构建/镜像构建服务支持的命令说明.md)。

1.  登录[ECS管理控制台](https://ecs.console.aliyun.com)。

2.  在左侧导航栏，选择**部署与弹性** \> **镜像构建**。

3.  在顶部菜单栏左上角处，选择地域。

4.  在**镜像构建管理**页面，单击**创建镜像模版**。

    如果您第一次访问镜像构建服务，将进入**镜像构建服务**欢迎页，此时请您单击**创建镜像模版**。

5.  完成镜像模版的配置项，然后单击**创建**。

    镜像模版的配置项说明如下各表所示。

    -   **基本配置**区域

        |配置项|说明|
        |---|--|
        |**构建模版名称**|必填。镜像模版的名称。|
        |**描述**|镜像模版的描述。|
        |**标签**|镜像模版的标签，用于统一管理资源。更多信息，请参见[标签概述](/cn.zh-CN/标签与资源/标签/标签概述.md)。|

    -   **配置源镜像**区域

        |配置项|说明|
        |---|--|
        |**通过Dockerfile导入模版**|您可以直接通过Dockerfile导入已编辑好的模版内容，该内容会覆盖您通过ECS控制台已配置的**源镜像类型**、**镜像**和**构建模版**信息，请谨慎操作。|
        |**源镜像类型**|支持设置**镜像**或**镜像族系**。|
        |**镜像**或**镜像族**|必填。配置项根据**源镜像类型**的设置有所不同。**说明：** 目前仅支持选择Linux系统的镜像。

        -   **源镜像类型**为**镜像**时，第一个下拉列表支持选择**自定义镜像**、**公共镜像**、**共享镜像**。第二个下拉列表选择对应的镜像ID或镜像版本。
        -   **源镜像类型**为**镜像族系**时，需要选择指定的**镜像族**。 |
        |**构建模版**|需要设置**命令**与**内容**。支持的命令请参见背景信息。设置完成后可以单击**预览模版**查看模版内容。**说明：** **命令**支持选择**已有组件**，对应的**内容**为组件ID。 |

    -   **配置中转实例**区域

        |配置项|说明|
        |---|--|
        |**虚拟交换机**|需要配置当前地域下可使用的交换机。如果不配置系统将默认创建临时的VPC和交换机，请确保您地域下的资源配额充足。|
        |**实例规格**|设置中转实例的实例规格。不设置值时，默认按vCPU和内存最小的原则，自动设置实例规格，并受实例规格的库存影响。例如，默认选择ecs.g6.large实例规格，如果库存不足，将选择ecs.g6.xlarge实例规格。|
        |**系统盘大小**|中转实例的系统盘大小。取值范围为20~500 GiB，默认值40 GiB。|
        |**公网带宽/M**|公网带宽默认值为0，即不具备公网访问能力。当您的镜像构建内容中存在需要访问公网的命令（例如下载命令）时，您必须设置一定值的公网带宽。否则镜像构建任务会失败。|
        |**镜像构建失败是否销毁中转实例**|您可以根据需求选择是否保留中转实例。**说明：** 如果您选择保留中转实例，实例将持续计费。当您不再需要中转实例时，请及时手动释放。具体操作，请参见[释放实例](/cn.zh-CN/实例/管理实例/释放实例.md)。 |

    -   **配置镜像分发**区域

        |配置项|说明|
        |---|--|
        |**目标镜像名称**|目标镜像名称前缀。最终完整的镜像名称由系统自动拼接名称前缀与构建任务ID（ExecutionId），格式为`自定义名称前缀_构建任务ID`。|
        |**当前地域**|系统展示ECS控制台当前所在地域。|
        |**默认分发地域**|如果需要将构建的镜像复制到多个地域，您可以设置分发地域，构建的镜像将会分发至指定地域。分发地域数量限制为0~20个。可以不设置分发地域。|
        |**共享UID**|如果需要将构建的镜像共享至其他阿里云账号，你可以设置共享UID，构建的镜像将会共享至同地域下指定的阿里云账号。共享UID数量限制为0~20个。可以不设置共享UID。**说明：** 您可以单击控制台页面右上角的用户头像，选择**账号管理** \> **安全设置**查看**账号ID**。 |
        |**创建后立即执行**|您可以根据需求选择是否立即执行构建镜像任务。如果不立即执行，您可以手动执行任务，具体操作，请参见[执行构建任务](/cn.zh-CN/镜像/镜像构建/查看与执行镜像模版.md)。|

    创建成功后，您可以在**镜像构建管理**页面查看已创建的镜像模版。


