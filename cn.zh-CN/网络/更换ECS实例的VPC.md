# 更换ECS实例的VPC

本章节介绍VPC网络类型的ECS实例如何更换到其他VPC。如果您在创建ECS实例时选错VPC或者需要重新规划网络，可以通过此功能更换单个或多个ECS实例的VPC。

-   ECS实例已处于停止状态。如何停止ECS实例，请参见[停止实例](/cn.zh-CN/实例/管理实例/停止实例.md)。

    **说明：** 对于创建后未重启过的ECS实例，您需要先重启实例，再停止实例。

-   ECS实例未加入SLB的后端服务器。SLB中如何移除后端服务器，请参见[移除后端服务器](/cn.zh-CN/用户指南/后端服务器/默认服务器组/移除后端服务器.md)。
-   ECS实例已卸载弹性网卡和多IP。如何卸载弹性网卡和多IP，请参见[解绑弹性网卡](/cn.zh-CN/网络/弹性网卡/解绑弹性网卡.md)和[回收辅助私网IP地址](/cn.zh-CN/网络/弹性网卡/回收辅助私网IP地址.md)。
-   已准备好更换的目标VPC、交换机和安全组。

## 使用场景

-   前期VPC规划不合理，随着业务的逐渐扩大，原来的VPC不能满足需求，需要通过ECS实例更换VPC操作进行重新规划。
-   前期只规划一个VPC，不同的项目和使用环境共用此VPC，存在数据操作风险。现在希望按项目、使用环境划分为单独的VPC，需要通过ECS实例更换VPC操作进行项目迁移。
-   希望跨账号VPC互联，但ECS实例在不同账号的默认VPC中，由于地址冲突无法建立跨账号互联。此时需要ECS实例更换VPC，解决地址冲突问题后，才能跨账号VPC互联。

## 使用限制

-   实例不能在其它云服务中被使用。例如，实例不能在迁移中、不能已在更换VPC或实例内部署的数据库不能被DTS服务管理等。
-   ECS实例变更前后的交换机必须在同一可用区。
-   ECS实例变更可选择1~5个目标安全组，但目标安全组类型必须一致（都是普通安全组或都是企业安全组）。
-   如果目标VPC开启了高级网络特性，则部分ECS实例规格族不支持更换。不支持的ECS实例规格族请参见[不支持VPC高阶特性的实例规格族](/cn.zh-CN/实例/不支持VPC高阶特性的实例规格族.md)。
-   批量更换ECS实例的VPC时，单次最多支持20个ECS实例。
-   更换ECS实例的VPC后，此ECS实例无法直接和原有VPC内的其他ECS实例互通。如果需要实现互通，请参见[什么是高速通道？](/cn.zh-CN/产品简介/什么是高速通道？.md)。
-   不支持配置了EIP网卡可见模式或多EIP网卡可见模式的实例。
-   不支持绑定高可用虚拟IP（HaVip）的实例。
-   不支持交换机绑定了自定义路由表的实例。
-   不支持开通了全球加速（GA）的实例。

## 操作步骤

1.  登录[ECS管理控制台](https://ecs.console.aliyun.com)。

2.  在左侧导航栏，单击**实例与镜像** \> **实例**。

3.  在顶部菜单栏左上角处，选择地域。

4.  单个或批量更换ECS实例的VPC。

    -   更换单个ECS实例的VPC

        找到目标ECS实例，在**操作**列中单击**更多** \> **网络和安全组** \> **更换专有网络**。

    -   批量更换多个ECS实例的VPC

        选中多个目标ECS实例，单击底部的**更多** \> **网络和安全组** \> **更换专有网络**。

5.  在**更换专有网络**配置向导页面，按照指引更换ECS实例的专有网络。

    ![更换vpc](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/5186649951/p120673.png)

    1.  在**变更准备**阶段，查看变更前的网络信息和注意事项，单击**下一步**。

    2.  在**选择专有网络**阶段，选择ECS需要切换的**目标专有网络**、**目标交换机**和**目标安全组**，单击**下一步**。

    3.  在**配置主私网IP**阶段，设置ECS切换后的主私网IP地址。

        -   设置的主私网IP需要在目标交换机的网段内。
        -   如果您不手动设置主私网IP，则主私网IP由系统自动分配。
    4.  单击**确定**。


切换完成后，您可以单击ECS实例ID，在**实例详情**页面的**网络信息**中查看切换后的专用网络和虚拟交换机。

**相关文档**  


[ModifyInstanceVpcAttribute](/cn.zh-CN/API参考/网络/ModifyInstanceVpcAttribute.md)

