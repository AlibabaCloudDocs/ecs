# 云盘缩容

由于目前云服务器ECS不支持系统盘或者数据盘缩容，如果您有云盘缩容的需求，可以通过阿里云服务器迁移中心SMC达成目的。

请确保您已完成迁移前的准备工作，更多信息，请参见[准备工作（迁移前必读）](/cn.zh-CN/用户指南/准备工作（迁移前必读）.md)。

SMC的研发初衷是为了平衡阿里云用户的云上及线下业务负载，但是您也可以利用其工作原理，实现云服务器ECS的云盘缩容。

SMC可以根据您的ECS实例重新创建一份自定义镜像，在创建过程中通过重新指定云盘大小，然后使用自定义镜像新购实例，以达到缩容的目的。除了将目标对象换成了ECS实例之外，云盘缩容和迁云这两种场景的使用方法和使用限制完全一致。由于使用对象为虚拟化的ECS实例，还可以降低报错机率，更加高效。

需要注意这种缩容方式，会引起原有ECS实例的部分属性发生变化，例如，实例ID（`InstanceId`）和公网IP。如果您的实例为专有网络VPC类型的实例，可以将公网IP转换为弹性公网IP以保留该公网IP。因此，建议使用弹性公网IP（EIP）或者对公网IP依赖程度较轻的用户使用该方式缩容。

1.  远程连接待缩容的ECS实例。

    具体操作，请参见[远程连接](/cn.zh-CN/实例/连接实例/使用第三方客户端工具连接实例/使用用户名密码验证连接Linux实例.md)。

2.  下载[SMC客户端](https://p2v-tools.oss-cn-hangzhou.aliyuncs.com/smc/Alibaba_Cloud_Migration_Tool.zip?file=Alibaba_Cloud_Migration_Tool.zip)。

3.  解压SMC客户端压缩包。

    SMC客户端为Windows和Linux系统均提供32位和64位版本（i386表示32位，x86\_64表示64位）。请根据迁移源的平台类型，选择相应的客户端版本。

4.  导入迁移源。具体操作，请参见[步骤一：导入迁移源](/cn.zh-CN/用户指南/步骤一：导入迁移源.md)。

5.  创建并启动迁移任务。

    迁移至指定目标实例完成云盘缩容，具体操作，请参见[源服务器迁移至目标实例](/cn.zh-CN/最佳实践/源服务器迁移至目标实例.md)。

    创建迁移任务时，**目标磁盘**中的**系统盘**和**数据盘**大小，设置为您需要缩容的预期值，该值不能小于系统盘或数据盘实际使用空间的大小。

6.  等待迁移任务完成。

    -   当迁移任务状态为**已完成**（Finished），表示任务完成并能够查看目标实例。
    -   当任务状态为**出错**（InError），表示任务失败。您需要查看日志修复问题后，再次重启迁移任务。常见错误及修复方案，请参见[SMC FAQ](/cn.zh-CN/常见问题/SMC FAQ.md)。

