# 实例生命周期

从创建实例开始到释放实例结束，实例可能处于不同的状态，这些状态组成了实例的生命周期。

## 实例状态

实例状态按查询位置分为控制台状态和API状态。控制台状态是可以在控制台中查询到的实例状态，API状态是调用[DescribeInstanceStatus](/cn.zh-CN/API参考/实例/DescribeInstanceStatus.md)或[DescribeInstances](/cn.zh-CN/API参考/实例/DescribeInstances.md)可以查询到的实例状态。一个API状态可能根据包年包月实例是否过期、账号是否欠费等原因对应多个控制台状态。

实例状态按属性分为稳定状态和中间状态。中间状态是实例在到达稳定状态前暂时处于的状态，如果实例长时间处于中间状态，说明出现了异常。

在实例生命周期中可能的状态如下表所示。

|控制台状态|API状态|状态属性|状态说明|
|:----|-----|:---|:---|
|待启动|Pending|中间状态|新创建实例，实例即将启动。|
|启动中|Starting|中间状态|新创建实例，或者对已有实例执行启动或重启操作，实例即将进入运行中（Running）状态。|
|运行中|Running|稳定状态|实例正常运行中。 **说明：** 实例仅在处于Running状态时才能接受访问，可能对应控制台的运行中或即将过期状态。 |
|即将过期|Running|稳定状态|包年包月实例正常运行中，但是即将过期。建议您及时续费实例，更多信息，请参见[续费概述](/cn.zh-CN/产品计费/续费实例/续费概述.md)。|
|停止中|Stopping|中间状态|对实例执行停止或休眠操作，实例即将进入已停止（Stopped）状态。|
|已停止|Stopped|稳定状态|实例已经创建完成等待启动，或者实例已经被停止或休眠。**说明：** 在控制台上或者调用RunInstances创建实例后，实例会自动启动，您无需手动启动。 |
|已过期|Stopped|稳定状态|包年包月实例已经到期，或者按量付费实例因账号欠费而停机，实例即将释放。关于实例的资源保留情况，请参见[到期后资源状态变化](/cn.zh-CN/产品计费/计费方式/包年包月.md)和[欠费后资源状态变化](/cn.zh-CN/产品计费/计费方式/按量付费.md)。|
|退款后过期|Stopped|稳定状态|包年包月实例已退款。为避免误操作导致数据丢失，相关资源会保留一定时间再释放，规则如下：-   vCPU、内存、固定公网IP、快照在退款后24小时内释放。
-   云盘在退款后15天内释放。

**说明：** 以上期限是最长保留时间，实际释放时间可能提前。 |
|过期回收中|Stopped|稳定状态|如果包年包月实例的网络类型为专有网络，在到期后释放前会先进入已过期（Stopped）状态，但随时会进入过期回收中（Stopped）状态。已过期（Stopped）状态和过期回收中（Stopped）状态下，实例的资源保留情况不同。更多信息，请参见[到期后资源状态变化](/cn.zh-CN/产品计费/计费方式/包年包月.md)。 |
|欠费回收中|Stopped|稳定状态|如果按量付费实例的网络类型为专有网络，在欠费停机后释放前会先进入已过期（Stopped）状态，但随时会进入欠费回收中（Stopped）状态。已过期（Stopped）状态和欠费回收中（Stopped）状态下，实例的资源保留情况不同。更多信息，请参见[欠费后资源状态变化](/cn.zh-CN/产品计费/计费方式/按量付费.md)。 |
|已锁定|Stopped|稳定状态|实例因为账户欠费、存在安全风险等原因被锁定。您可以[提交工单](https://selfservice.console.aliyun.com/ticket/createIndex)申请解锁。|
|等待释放|Stopped|稳定状态|已申请退款提早释放包年包月实例。具体操作，请参见[申请退款](https://help.aliyun.com/document_detail/37096.html)。 |

## 管理实例状态

实例API状态的转换流程示意图如下所示。

![](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7793359951/p5105.png)

创建实例等操作会直接影响实例状态，建议您使用控制台、API等阿里云提供的管理工具管理实例状态。例如，如果需要在停机时启用停机不收费模式、重启实例使修改的主机名生效，必须使用控制台、API等管理工具操作，在操作系统内操作无效。

管理实例状态的常见操作及说明如下：

-   [创建实例](/cn.zh-CN/实例/创建实例/创建方式导航.md)

    实例先进入待启动（Pending）状态，然后进入启动中（Starting）状态，最终进入运行中（Running）状态。此时实例可以接受访问，例如您可以连接实例管理操作系统设置、在实例上搭建网站后通过浏览器访问等。

-   [停止实例](/cn.zh-CN/实例/管理实例/停止实例.md)

    实例先进入停止中（Stopping）状态，最终进入已停止（Stopped）状态。在执行一些操作前，您需要先停止实例，例如实例更换操作系统、实例修改私有IP地址、按量付费实例变配实例规格等。

    如果按量付费实例的停止模式为停机不收费，停机后会释放计算资源（vCPU和内存）和固定公网IP并停止收取相关费用，但保留云盘、EIP等其他资源并继续收取相关费用。

-   [启动实例](/cn.zh-CN/实例/管理实例/启动实例.md)

    实例先进入启动中（Starting）状态，最终进入运行中（Running）状态。

-   [休眠实例](/cn.zh-CN/实例/管理实例/休眠实例.md)

    实例先进入停止中（Stopping）状态，最终进入已停止（Stopped）状态。休眠实例时，操作系统会将内存中的数据（包括运行的应用程序及其状态）保留至实例的系统盘。当再次启动实例时，操作系统会读取保留的内存数据，并快速恢复休眠前运行的应用程序及其状态。

    如果按量付费实例开启了休眠不收费，休眠后会释放计算资源（vCPU和内存）和固定公网IP并停止收取相关费用，但保留云盘、EIP等其他资源并继续收取相关费用。

-   [重启实例](/cn.zh-CN/实例/管理实例/重启实例.md)

    实例先进入停止中（Stopping）状态，然后进入启动中（Starting）状态，最终进入运行中（Running）状态。在执行一些操作后，您需要重启实例使其生效，例如修改实例规格等。

    实例在重启后可能被调度到其他宿主机上，如果您需要实例始终部署在指定的宿主机上，可以购买专有云宿主机并为实例启用关联宿主机。

-   [释放实例](/cn.zh-CN/实例/管理实例/释放实例.md)

    您只能释放API状态为Stopped的实例，可能对应控制台中的已停止、已过期等状态。不支持直接释放未到期的包年包月实例，如需在到期前释放包年包月实例，请申请退款或者转为按量付费实例。

    实例释放后，实例ID、固定公网IP、系统盘、设置随实例释放的数据盘等数据和资源随之释放且不可恢复，EIP、设置不随实例释放的数据盘等独立的资源自动解绑。请慎重执行释放操作，如果需要规避误操作释放实例，您可以为实例启用释放保护。


