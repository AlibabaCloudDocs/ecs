---
keyword: [地域级, 可用区级]
---

# 预留实例券与实例的匹配

购买预留实例券即代表承诺使用一定时长的按量付费实例，预留实例券匹配按量付费实例后才能抵扣账单。如果您的账号下暂时没有可以匹配的按量付费实例，预留实例券会闲置但继续计费。本章节为您介绍预留实例券匹配按量付费实例的规则和示例。

## 匹配规则

您不能手动匹配预留实例券和按量付费实例。购买预留实例券后，在有效期内预留实例券将自动匹配满足条件的按量付费实例。匹配成功后，预留实例券每小时检查可抵扣的按量付费账单，并按券面的计算力抵扣账单。您可以使用抵扣预测功能查看预留实例券可以匹配的实例，具体操作请参见[查看可抵扣的实例](/cn.zh-CN/实例/选择实例购买方式/预留实例券/查看可抵扣的实例.md)。

地域级预留实例券和可用区级预留实例券的匹配条件存在差别，以下属性决定了预留实例券能否成功匹配按量付费实例。

|属性|地域级预留实例券|可用区级预留实例券|
|--|--------|---------|
|地域和可用区|支持可用区灵活性，在指定地域中可以跨可用区匹配按量付费实例。|只可匹配同一可用区中的按量付费实例。|
|实例规格|实例大小灵活性和资源预留支持情况如下： -   支持实例大小灵活性，在指定实例规格族中可以用小规格券匹配大规格实例，也可以用大规格券匹配小规格实例。
-   不支持资源预留。

|实例大小灵活性和资源预留支持情况如下： -   只可匹配实例大小相同的按量付费实例。
-   支持资源预留，在有效期内预留指定数量指定规格的实例，保证随时可以在指定可用区中成功创建按量付费实例。 |
|操作系统平台|只可匹配操作系统平台相同的按量付费实例。|只可匹配操作系统平台相同的按量付费实例。|

## 地域级预留实例券示例

根据匹配要求，待匹配的地域级预留实例券和按量付费实例必须满足以下条件：

-   地域相同，支持跨可用区匹配实例。
-   实例规格族相同，支持小规格券匹配大规格实例和大规格券匹配小规格实例。

    **说明：** 实例大小不同时可以通过计算力评估预留实例券的使用情况。

-   操作系统平台相同。

使用地域级预留实例券的示例如下表所示。

|示例场景|按量付费实例|地域级预留实例券|抵扣效果|
|----|------|--------|----|
|小规格券匹配大规格实例|持有1台按量付费实例，配置如下： -   华北1（青岛） 可用区B
-   ecs.g5.4xlarge
-   Linux

|持有2张已生效的地域级预留实例券，属性如下： -   华北1（青岛）跨可用区
-   ecs.g5.xlarge
-   Linux
-   实例数量：2台

|计算力因子如下： -   ecs.g5.4xlarge计算力因子为16。
-   ecs.g5.xlarge计算力因子为4。

计算力对比如下：

-   按量付费实例：1台实例每小时消耗计算力16（1台\*16）。
-   预留实例券：1张券每小时交付计算力8（2台\*4）。

因此，每张预留实例券每小时抵扣1台按量付费实例50%的账单，2张预留实例券每小时可抵扣1台按量付费实例100%的账单。 |
|大规格券匹配小规格实例|持有6台按量付费实例。 -   1台实例的配置如下：
    -   华北1（青岛） 可用区B
    -   ecs.g5.xlarge
    -   Linux
-   5台实例的配置如下：
    -   华北1（青岛） 可用区C
    -   ecs.g5.xlarge
    -   Linux

|持有2张已生效的地域级预留实例券。 -   1张券的属性如下：
    -   华北1（青岛）跨可用区
    -   ecs.g5.4xlarge
    -   Linux
    -   实例数量：1台
-   1张券的属性如下：
    -   华北1（青岛）跨可用区
    -   ecs.g5.2xlarge
    -   Linux
    -   实例数量：1台

|计算力因子如下： -   ecs.g5.xlarge计算力因子为4。
-   ecs.g5.2xlarge计算力因子为8。

计算力对比如下：

-   按量付费实例：6台实例每小时消耗计算力24（6台\*4）。
-   预留实例券：2张券每小时分别交付计算力16（1台\*16）和8（1台\*8）。

因此，2张预留实例券每小时抵扣6台按量付费实例100%的账单。

**说明：** 按量付费实例位于2个可用区中，但地域级预留实例券支持可用区灵活性，不影响抵扣。 |
|匹配失败|持有2台按量付费实例。 -   1台实例配置如下：
    -   华北1（青岛） 可用区B
    -   ecs.g5.xlarge
    -   Windows
-   1台实例配置如下：
    -   华东1（杭州） 可用区B
    -   ecs.c5.xlarge
    -   Linux

|持有2张已生效的地域级预留实例券。 -   1张券的属性如下：
    -   华北1（青岛）跨可用区
    -   ecs.g5.4xlarge
    -   Linux
    -   实例数量：1台
-   1张券的属性如下：
    -   华北1（青岛）跨可用区
    -   ecs.g5.xlarge
    -   Linux
    -   实例数量：1台

|导致匹配按量付费实例失败的原因如下： -   1台实例的操作系统平台为Windows。
-   1台实例的地域为华东1（杭州）且实例规格族为c5。

因此，预留实例券闲置并继续计费，按量付费实例的账单通过账户额度结算。 |

## 可用区级预留实例券示例

根据匹配要求，待匹配的可用区级预留实例券和按量付费实例必须满足以下条件：

-   地域和可用区相同。
-   实例规格族和实例大小相同。
-   操作系统平台相同。

使用可用区级预留实例券的示例如下表所示。

|示例场景|按量付费实例|可用区级预留实例券|抵扣效果|
|----|------|---------|----|
|匹配成功|持有5台按量付费实例，配置如下： -   华北1（青岛） 可用区B
-   ecs.g5.xlarge
-   Windows

|持有1张已生效的可用区级预留实例券，属性如下： -   华北1（青岛）可用区B
-   ecs.g5.xlarge
-   Windows
-   实例数量：5台

|预留实例券和5台按量付费实例完全匹配，1张预留实例券每小时抵扣5台按量付费实例100%的账单。|
|资源预留|未持有按量付费实例。|持有1张已生效的可用区级预留实例券。 -   华北1（青岛）可用区B
-   ecs.g5.2xlarge
-   Linux
-   实例数量：10台

|预留实例券闲置并继续计费。但会在有效期内为您预留10台ecs.g5.2xlarge实例，保证随时可以在华北1（青岛）可用区B中成功创建按量付费实例。|
|匹配失败|持有2台按量付费实例。 -   1台实例配置如下：
    -   华北1（青岛） 可用区B
    -   ecs.g5.xlarge
    -   Windows
-   1台实例配置如下：
    -   华北1（青岛） 可用区C
    -   ecs.g5.4xlarge
    -   Linux

|持有2张已生效的可用区级预留实例券。 -   1张券的属性如下：
    -   华北1（青岛）可用区B
    -   ecs.g5.xlarge
    -   Linux
    -   实例数量：1台
-   1张券的属性如下：
    -   华北1（青岛）可用区B
    -   ecs.g5.xlarge
    -   Linux
    -   实例数量：1台

|导致匹配按量付费实例失败的原因如下： -   1台实例的操作系统平台为Windows。
-   1台实例的可用区为华北1（青岛）可用区C且实例规格为ecs.g5.4xlarge。

因此，预留实例券闲置并继续计费，按量付费实例的账单通过账户额度结算。 |

## 单券匹配多台实例

地域级和可用区级预留实例券均支持单券匹配多台实例，但不支持通过缩短有效期在短时间内交付更大计算力。

假设您持有6台按量付费实例和1张已生效的预留实例券，如下表所示。

|6台按量付费实例|1张预留实例券|
|--------|-------|
|每台实例配置如下： -   华北1（青岛） 可用区B
-   ecs.g5.6xlarge
-   Linux
-   实例规格计算力因子：24

|券的属性如下： -   华北1（青岛）可用区B
-   ecs.g5.6xlarge
-   Linux
-   实例规格计算力因子：24
-   实例数量：1台
-   有效期：1年 |

可见6台按量付费实例均符合匹配条件。在1小时内，根据每台实例的持有时长，预留实例券的抵扣示例如下表所示。

|6台按量付费实例|1张预留实例券|抵扣效果|
|--------|-------|----|
|计算力消耗情况如下： -   每台实例持有时长：1小时（每台消耗计算力24）
-   6台实例每小时消耗计算力：144（6台\*24）

|计算力交付情况如下： 1张券每小时交付计算力：24（1台\*24）

|预留实例券交付的计算力等于1台按量付费实例消耗的计算力。随机抵扣1台实例的账单，不会通过将有效期缩短为2个月同时抵扣6台实例的账单。|
|计算力消耗情况如下： -   每台实例持有时长：10分钟（每台消耗计算力24÷6）
-   6台实例每小时消耗计算力：24（6台\*24÷6）

|计算力交付情况如下： 1张券每小时交付计算力：24（1台\*24）

|预留实例券交付的计算力等于6台按量付费实例消耗的计算力，抵扣6台实例的账单。|
|计算力消耗情况如下： -   每台实例持有时长：15分钟（每台消耗计算力24÷4）
-   6台实例每小时消耗计算力：36（6台\*24÷4）

|计算力交付情况如下： 1张券每小时交付计算力：24（1台\*24）

|预留实例券交付的计算力小于6台按量付费实例消耗的计算力，抵扣满1小时计算力的账单，但每台实例的具体抵扣金额随机。|

## 跨账号匹配实例

如果您需要统一管理多个阿里云账号的财务关系，可以使用用户中心的企业财务功能。企业财务功能支持在阿里云账号间建立财务托管关系，由主账号支付子账号的费用。建立财务托管关系后，可以共享在主账号中的预留实例券，用于匹配子账号中的按量付费实例并抵扣账单。具体共享操作，请参见[账户一览](https://help.aliyun.com/document_detail/60561.html)中的资源共享章节。

**说明：** 企业财务功能中，主账号、子账号都是指独立的阿里云帐号，用于授权管理财务。和访问控制中的主账号、RAM用户的概念不同。

跨账号匹配存在以下限制：

-   不支持共享子账号中的预留实例券。
-   不支持共享可用区级预留实例券的库存预留能力。建议您在跨帐号匹配的场景中使用地域级预留实例券，可用区级预留实例券转为地域级预留实例券的操作，请参见[修改预留实例券](/cn.zh-CN/实例/选择实例购买方式/预留实例券/修改预留实例券.md)。

