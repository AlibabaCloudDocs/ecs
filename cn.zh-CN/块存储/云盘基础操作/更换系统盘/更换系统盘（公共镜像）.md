---
keyword: [更换操作系统, 更换镜像, 重装系统, 重装windows, 重装Linux]
---

# 更换系统盘（公共镜像）

更换系统盘即更换ECS实例的操作系统。更换时会为ECS实例重新分配一块系统盘，此时系统盘ID会更新，旧系统盘会被释放。系统盘的云盘类型、实例IP地址以及弹性网卡MAC地址保持不变。如果您在创建ECS实例时选择了错误的操作系统，或者需要使用其他操作系统，您能通过更换系统盘来更换操作系统。

-   更换系统盘后旧系统盘会被释放，建议您为当前系统盘创建快照备份数据。具体操作，请参见[创建快照](/cn.zh-CN/快照/使用快照/创建一个云盘快照.md)。

    **说明：** 创建快照应避开业务高峰期，避免影响业务。一块40 GiB的系统盘，首次创建快照需要约20分钟，请预留出足够的时间。

-   ECS实例处于**已停止**状态。 若尚未停止，具体操作请参见[停止实例](/cn.zh-CN/实例/管理实例/停止实例.md)。

    **警告：**

    -   停止ECS实例，会中断您的业务，请谨慎操作。
    -   按量付费的VPC类型实例在停机不收费模式下，更换系统盘后可能无法成功启动目标实例。建议您停止实例时选择**停止后仍旧保留实例并继续收费**。

更换系统盘是高风险操作，更换系统盘前，请务必阅读以下注意事项：

-   您需要在新系统盘中重新部署业务运行环境，有可能会对您的业务造成长时间的中断。
-   历史系统盘快照不能用于回滚新系统盘。
-   您手动创建的快照不会被释放，这些快照仍可以创建自定义镜像。如果旧系统盘设置了自动快照随磁盘释放，则自动快照会被自动删除。
-   如果更换前后都是Linux系统，且ECS实例上挂载了数据盘并设置了开机自动挂载分区。更换系统盘后，旧系统盘中的数据盘分区挂载信息丢失。您需要自行更新/etc/fstab配置，请参见[后续操作](#postreq_whatToDoNext)。
-   如果要跨操作系统更换系统盘，请注意：
    -   非中国内地地域不支持切换Windows Server系统和Linux系统，仅支持Windows Server不同版本之间或Linux不同发行版本之间的更换。
    -   提前检查实例主机名（HostName）已经符合目标系统的限制，并删除目标系统不支持的字符。修改主机名请参见[修改实例属性](/cn.zh-CN/实例/管理实例/修改实例属性.md)或[ModifyInstanceAttribute](/cn.zh-CN/API参考/实例/ModifyInstanceAttribute.md)。
    -   从Windows Server系统更换为Linux系统时，可以选择SSH密钥对认证，但您必须已经创建过SSH密钥对。具体操作，请参见[创建SSH密钥对](/cn.zh-CN/安全/SSH密钥对/使用SSH密钥对/创建SSH密钥对.md)。
    -   Linux缺省情况下无法识别NTFS格式，Windows Server缺省情况下无法识别ext3、ext4、XFS等文件系统格式。根据您的数据盘有无重要数据，分别建议如下：
        -   没有重要数据时，重新初始化数据盘，再将其格式化为目标系统支持的文件系统。具体操作，请参见[重新初始化数据盘](/cn.zh-CN/块存储/云盘基础操作/重新初始化云盘/重新初始化系统盘.md)。
        -   有重要数据时，单独安装软件识别。例如NTFS-3G（Windows Server系统更换为Linux系统时），或者Ext2Read和Ext2Fsd（Linux系统更换为Windows Server系统时）。
-   如果要更换Windows Server系统，请注意：
    -   系统盘必须有足够的空间，至少预留1 GiB以上。否则，更换系统盘后ECS实例可能无法启动。
    -   微软已经停止支持Windows Server 2003。为了保证您的数据安全，阿里云不推荐ECS实例继续使用Windows Server 2003系统，也不再提供该镜像。详情请参见[关于阿里云不再支持Windows Server 2003公共镜像](https://help.aliyun.com/document_detail/59513.html)。
    -   如果您使用的是非I/O优化实例，仅支持更换为下列Windows Server公共镜像，且只能调用API [ReplaceSystemDisk](/cn.zh-CN/API参考/块存储/ReplaceSystemDisk.md)完成操作。

        |镜像版本|镜像ID|
        |:---|:---|
        |Windows Server 2012 R2数据中心版中文|win2012r2\_64\_dtc\_17196\_zh-cn\_40G\_alibase\_20170915.vhd|
        |Windows Server 2012 R2数据中心版英文|win2012r2\_64\_dtc\_17196\_en-us\_40G\_alibase\_20170915.vhd|
        |Windows Server 2016数据中心版中文|win2016\_64\_dtc\_1607\_zh-cn\_40G\_alibase\_20170915.vhd|
        |Windows Server 2016数据中心版英文|win2016\_64\_dtc\_1607\_en-us\_40G\_alibase\_20170915.vhd|
        |Windows Server 2008 R2企业版中文|win2008r2\_64\_ent\_sp1\_zh-cn\_40G\_alibase\_20170915.vhd|
        |Windows Server 2008 R2企业版英文|win2008r2\_64\_ent\_sp1\_en-us\_40G\_alibase\_20170915.vhd|

        **说明：** 微软已经于2020年1月14日停止对Windows Server 2008和Windows Server 2008 R2操作系统提供支持。因此阿里云不再对使用上述操作系统的ECS实例提供技术支持。如果您有使用上述操作系统的ECS实例，请尽快更新至Windows Server 2012或以上版本。


除了通过ECS管理控制台逐一更换系统盘外，您还可以通过OOS公共模板ACS-ECS-BulkyReplaceSystemDisk批量更换。更多详情，请访问[OOS管理控制台](https://oos.console.aliyun.com/cn-hangzhou/execution/create/ACS-ECS-BulkyReplaceSystemDisk)。

## 操作步骤

1.  登录[ECS管理控制台](https://ecs.console.aliyun.com)。

2.  在左侧导航栏，选择**实例与镜像** \> **实例**。

3.  在顶部菜单栏左上角处，选择地域。

4.  在**实例列表**页，找到待更换系统盘的目标实例。

5.  在**操作**列中，选择**更多** \> **磁盘和镜像** \> **更换操作系统**。

6.  在弹出的对话框里，仔细阅读更换系统盘注意事项后，单击**确定，更换操作系统**。

7.  在更换操作系统页面上，配置以下参数。

    1.  **镜像类型**：选择**公共镜像**，并选择镜像版本。

        如果您需要使用其他镜像，请参见[更换系统盘（非公共镜像）](/cn.zh-CN/块存储/云盘基础操作/更换系统盘/更换系统盘（非公共镜像）.md)。

    2.  **系统盘**：不能更换系统盘的云盘类型，根据业务需求和新镜像的需求设置不低于系统盘当前容量的数值。

        新容量最大不能超过500 GiB，最小容量与系统盘当前容量和镜像有关，如下表所示。

        |镜像|容量限制（GiB）|
        |:-|:--------|
        |CoreOS与FreeBSD|\[max\{30, 系统盘当前容量\}, 500\]|
        |其他Linux|\[max\{20, 系统盘当前容量\}, 500\]|
        |Windows Server|\[max\{40, 系统盘当前容量\}, 500\]|

        **说明：** 如果您的实例已经做过续费降配操作，进入下一个计费周期前，您不能修改系统盘容量。

    3.  **安全设置**：设置登录认证方式。

        -   Windows Server系统只支持密码认证。

            ![操作系统是Windows系统，您只能使用密码认证](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1263359951/p5517.png)

        -   I/O优化实例的Linux系统支持密码认证或SSH密钥对认证。

            ![设置登录密码或者绑定SSH密钥对](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1263359951/p5518.png)

    4.  确认配置费用并选中相应的服务协议，然后单击**确认订单**。

        -   有关镜像的计费详情，请参见[镜像概述](/cn.zh-CN/镜像/镜像概述.md)。
        -   系统盘按起始容量起售，起始容量按起售价收费，超过起始容量后，每增加1 GiB按线性计费价格收费。起始容量的系统盘，包年包月价格的单位为元/月，按量付费价格的单位为元/小时。系统盘价格请参见[云产品价格页](https://www.aliyun.com/price/product#/ecs/detail)。
    以下示例演示了如何将ECS实例从Windows Server系统更换为公共镜像的CentOS系统。

    ![替换系统盘](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1263359951/p95280.gif)


返回ECS管理控制台，大约10分钟后，系统盘更换完成，ECS实例的状态自动变更为**运行中**。单击实例ID进入**实例详情页**，显示为更换后的镜像。

更换系统盘后，您需要做以下操作：

-   （可选）旧系统盘上应用的自动快照策略自动失效，您需要对新系统盘设置自动快照策略。具体操作，请参见[执行或取消自动快照策略](/cn.zh-CN/快照/使用自动快照策略/执行或取消自动快照策略.md)。
-   为了保证有足够的快照额度完成新系统盘的自动快照策略，您可以删除不需要的旧系统盘快照。具体操作，请参见[删除快照](/cn.zh-CN/快照/使用快照/删除快照.md)。
-   （可选）仅Linux系统：在新系统盘的/etc/fstab文件写入新分区信息，并挂载分区。不需要对数据盘格式化并分区。操作步骤如下，具体的操作命令，请参见[Linux格式化数据盘](/cn.zh-CN/块存储/云盘基础操作/分区格式化数据盘/Linux格式化数据盘.md)。

    1.  建议：备份/etc/fstab。
    2.  向/etc/fstab写入新分区信息。
    3.  查看etc/fstab中的新分区信息。
    4.  运行命令`mount`挂载分区。
    5.  运行命令`df -h`，查看文件系统空间和使用情况。
    挂载分区后，不需要重启实例即可开始使用数据盘。


